<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <!-- Meta tags for character set and viewport -->
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Page title and linking to external CSS file -->
    <title>Tournament Management and Athlete Empowerment</title>
    <link rel="stylesheet" href="/CSSFile.css">
    <link rel="icon" href="/backgrounds/icon.png">
</head>
<body id="bracket-page" class="background">
<div class="header">
    <h1 class="headerText">Tournament Management and Athlete Empowerment</h1>
</div>
<div th:include="/navbar :: navbar"></div>
<div class="container">
    <h1 class="page-description" th:text="${tournamentName} + ' Bracket'"></h1>
    <div id="bracket-container">
        <div th:each="round : ${bracket}" th:class="'round ' + (${round[0][0] != 1} ? 'child-column' : '')">
            <h5 th:text="'Round ' + ${round.get(0).get(0)}" id="bracket-round-label"></h5>
            <div th:each="matchup : ${round}" class="bracket-matches">
                <div th:if="${matchup[0] == round[0][0]}">
                    <a th:if="${matchup[1] != null}" th:href="@{'/matches/' + ${matchup[1]}}"
                       class="bracket-match-link">
                        <div class="match-participant">
                            <p th:class="${matchup[6]} ? 'bracket-match-loser' : 'participant-name'" th:text="${matchup[2]}"></p>
                            <p class="participant-score" th:text="${matchup[4]}"></p>
                        </div>
                        <div class="match-participant">
                            <p th:class="${matchup[7]} ? 'bracket-match-loser' : 'participant-name'" th:text="${matchup[3]}"></p>
                            <p class="participant-score" th:text="${matchup[5]}"></p>
                        </div>
                    </a>
                    <div th:unless="${matchup[1] != null}" class="bracket-match-link">
                        <!-- Render the content without a link -->
                        <div class="match-participant">
                            <p class="participant-name" th:text="${matchup[2]}"></p>
                            <p class="participant-score" th:text="${matchup[4]}"></p>
                        </div>
                        <div class="match-participant">
                            <p class="participant-name" th:text="${matchup[3]}"></p>
                            <p class="participant-score" th:text="${matchup[5]}"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    // JavaScript code goes here
    // Get all elements with the class 'child-column .bracket-matches:not(:last-child)'
    var columns = document.querySelectorAll('.child-column');

    columns.forEach(function(column, index) {
        // Get all elements within the current column
        var elements = column.querySelectorAll('.bracket-matches:not(:last-child)');

        // Define a margin multiplier (e.g., doubling for each column)
        var marginMultiplier = Math.pow(2, index);

        // Loop through each element in the current column
        elements.forEach(function(element) {
            // Get the computed style of the element
            var computedStyle = window.getComputedStyle(element);

            // Calculate the rendering height of the element (including padding, border, and margin)
            var height = element.offsetHeight +
                parseFloat(computedStyle.marginTop) +
                parseFloat(computedStyle.marginBottom);

            // Set the bottom margin to be the same height as the element multiplied by the marginMultiplier
            element.style.marginBottom = height * marginMultiplier + 'px';
        });
    });
</script>
</body>
</html>